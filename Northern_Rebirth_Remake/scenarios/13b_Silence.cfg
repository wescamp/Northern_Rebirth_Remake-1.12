#textdomain wesnoth-Northern_Rebirth_Remake

[scenario]
    id=13b_Silence
    name= _ "Silence"

    {SCENARIO_MUSIC "northerners.ogg"}
    {EXTRA_SCENARIO_MUSIC "siege_of_laurelmor.ogg"}
    {EXTRA_SCENARIO_MUSIC "knalgan_theme.ogg"}
    {EXTRA_SCENARIO_MUSIC "loyalist.ogg"}

    [story]
        [part]
            story= _ "The plan was simple: the joined forces of humans, dwarfs and Tallin's troops had to surround and destroy Rakshas army. As soon as his scouts returned with news about Rakshas gathering countless warriors for a counter-attack in a large stronghold not so far to the south, they set off."
        [/part]
        [part]
            story= _ "Tallin's army marched fast and undisturbed, only outrun by his fame as the Silent Warlord. Orcs were fleeing before him, whispering that only silence was left behind were he treaded."
        [/part]
    [/story]

    {DEFAULT_SCHEDULE}

    [time_area]
        {UNDERGROUND}
        x=22,23,24-25,26-27,28,29,36-37,38,39,40,41,25,26,27,28,29,30,31,32-33,34,35,35,37,35,28,29,30,31,32
        y=28,28-29,27-28,26-27,25-26,26,25-31,24-32,26-31,26-30,27-30,36,35-36,35-37,35-37,36-38,35-37,36-38,35-37,35-36,26,31,32,36,29-31,29-32,28-32,29-32,29-31
    [/time_area]

    turns=-1
    next_scenario=14b_Epilogue
    map_data="{~add-ons/Northern_Rebirth_Remake/maps/13b_Silence.map}"

    #define OBJECTIVES_SILENCE CHARACTER_DEATH
        [objectives]
            side=1
            [objective]
                description= _ "Defeat enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Tallin"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Hamel"
                condition=lose
            [/objective]
            [objective]
                description={CHARACTER_DEATH}
                condition=lose
            [/objective]

            {GOLD_CARRYOVER_NONE}
            {IS_LAST_SCENARIO}
        [/objectives]
    #enddef

    #define PUT_STRONGHOLD_GUARD TYPE ROLE X Y
        [unit]
            side=4
            type={TYPE}
            role={ROLE}
            [modifications]
                [object]
                    silent=yes
                    # Do not ever use replace if you want to have easy way to get back original state
                    [effect]
                        apply_to=movement_costs 
                        replace=false
                        [movement_costs]
                            flat=30
                            shallow_water=30
                        [/movement_costs]
                    [/effect]
                [/object]
            [/modifications]
            ai_special=guardian
            x={X}
            y={Y}
        [/unit]
    #enddef

    #define ORCISH_REINFORCEMENT SIDE EASY NORMAL HARD NIGHTMARE
        [if]
            [have_unit]
                side={SIDE}
                canrecruit=yes
            [/have_unit]
        [then]
            [gold]
                side={SIDE}
                {QUANTITY4 amount {EASY} {NORMAL} {HARD} {NIGHTMARE}}
            [/gold]
        [/then]
        [/if]
    #enddef

    #define ORCISH_ARMY SIDE EASY NORMAL HARD NIGHTMARE
        [if]
            [have_unit]
                side={SIDE}
                canrecruit=yes
            [/have_unit]
        [then]
            [store_gold]
                side={SIDE}
                variable=orcish_gold
            [/store_gold]

            [if]
                [variable]
                    name=orcish_gold
                    less_than=0
                [/variable]
            [then]
                [modify_side]
                    side={SIDE}
                    {GOLD4 {EASY} {NORMAL} {HARD} {NIGHTMARE}}
                [/modify_side]
            [/then]
            [else]
                [gold]
                    side={SIDE}
                    {QUANTITY4 amount {EASY} {NORMAL} {HARD} {NIGHTMARE}}
                [/gold]
            [/else]
            [/if]

            {CLEAR_VARIABLE orcish_gold}
        [/then]
        [/if]
    #enddef

    #define TAKE_COMMAND SIDE
        [store_unit]
            [filter]
                role=Warlord
            [/filter]
            kill=no
            variable=warlords
        [/store_unit]

        {CLEAR_VARIABLE warlords[0].ai_special}
        {VARIABLE warlords[0].role Sovereign}
        {VARIABLE warlords[0].canrecruit yes}
        {VARIABLE warlords[0].side {SIDE}}

        [kill]
            id=$warlords[0].id
        [/kill]

        [unstore_unit]
            variable=warlords[0]
        [/unstore_unit]

        [if]
            [variable]
                name=guards_protect
                less_than=1
            [/variable]
        [then]
            [object]
                silent=yes
                [filter]
                    x,y=$warlords[0].x,$warlords[0].y
                [/filter]
                [effect]
                    apply_to=movement_costs
                    replace=false
                    [movement_costs]
                        flat=-30
                        shallow_water=-30
                    [/movement_costs]
                [/effect]
            [/object]
        [/then]
        [/if]

        {SPEAKER_GENERIC (id=$warlords[0].id) ( _ "YES, MASTER!")}

        {CLEAR_VARIABLE warlords}

        [gold]
            side={SIDE}
            {QUANTITY4 amount 550 700 850 1000}
        [/gold]
    #enddef

    #define PROTECT_SOVEREIGN
        [if]
            [variable]
                name=guards_protect
                less_than=1
            [/variable]
        [then]
            [if]
                [have_unit]
                    side=4
                    role=Warlord
                [/have_unit]
                [or]
                    [have_unit]
                        side=4
                        role=Guard
                    [/have_unit]
                [/or]
            [then]
                {SPEAKER_GENERIC (speaker=Rakshas) ( _ "No. No! NO! GUARDS!! KILL THEM!")}

                [store_unit]
                    [filter]
                        role=Guard
                    [/filter]
                    kill=no
                    variable=guarding_units
                [/store_unit]

                {FOREACH guarding_units i}

                [object]
                    silent=yes
                    [filter]
                        x,y=$guarding_units[$i].x,$guarding_units[$i].y
                    [/filter]
                    [effect]
                        apply_to=movement_costs
                        replace=false
                        [movement_costs]
                            flat=-30
                            shallow_water=-30
                        [/movement_costs]
                    [/effect]
                [/object]

                {NEXT i}

                {CLEAR_VARIABLE guarding_units}

                [store_unit]
                    [filter]
                        role=Warlord
                    [/filter]
                    kill=no
                    variable=guarding_units
                [/store_unit]

                {FOREACH guarding_units i}

                [object]
                    silent=yes
                    [filter]
                        x,y=$guarding_units[$i].x,$guarding_units[$i].y
                    [/filter]
                    [effect]
                        apply_to=movement_costs
                        replace=false
                        [movement_costs]
                            flat=-30
                            shallow_water=-30
                        [/movement_costs]
                    [/effect]
                [/object]

                {NEXT i}

                {CLEAR_VARIABLE guarding_units}

                {VARIABLE guards_protect 1}
            [/then]
            [/if]
        [/then]
        [else]
            [allow_undo][/allow_undo]
        [/else]
        [/if]
    #enddef

    #define WIZARDS_ARRIVE VILLAGE X Y
        [if]
            [variable]
                name=wizards_arrived
                less_than=1
            [/variable]
            [and]
                [have_unit]
                    side=4
                    canrecruit=yes
                [/have_unit]
            [/and]
        [then]
            {VARIABLE wizards_arrived 1}
            {UNIT 6 "Silver Mage" {X} {Y} (
                id=Leogwyndar
                name= _ "Leogwyndar"
                canrecruit=yes
                [modifications]
                    {TRAIT_RESILIENT}
                    {TRAIT_STRONG}
                [/modifications]
            )}

            [capture_village]
                side={VILLAGE}
                x={X}
                y={Y}
            [/capture_village]

            {ANIMATE_UNIT Leogwyndar post_teleport ()}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Finally you are here!")}
            {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "As we agreed Emperor Rakshas.")}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "As agreed? You are late.")}
            {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "Emperor Rakshas. Mages are not orcs. They do not grow on trees. So gathering the requested number of them took quite some time.")}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Never mind. You get lost on the front line!")}
            {SPEAKER_GENERIC (speaker=Raolsg) ( _ "Master...")}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Would you lead my troops against those pesky necromancers and their despicable allies?")}
            {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "Of course Emperor Rakshas.")}

            [store_unit]
                [filter]
                    id=Raolsg
                [/filter]
                variable=orcish_leader
            [/store_unit]

            {VARIABLE orcish_leader.side 4}

            {CLEAR_VARIABLE orcish_leader.canrecruit}
            {CLEAR_VARIABLE orcish_leader.role}

            [unstore_unit]
                variable=orcish_leader
            [/unstore_unit]

            {CLEAR_VARIABLE orcish_leader}

            {ORCISH_ARMY 6 550 700 850 1000}
            {ORCISH_ARMY 4 225 350 425 500}
            {ORCISH_ARMY 5 225 350 425 500}
            {ORCISH_ARMY 7 225 350 425 500}
            [allow_recruit]
                side=6
                type=Red Mage,Silver Mage
            [/allow_recruit]

            #ifdef EASY
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Red Mage" 2}
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Silver Mage" 2}
            #endif

            #ifdef NORMAL
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Red Mage" 4}
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Silver Mage" 2}
            #endif

            #ifdef HARD
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Red Mage" 6}
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Silver Mage" 3}
            #endif

            #ifdef NIGHTMARE
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Red Mage" 8}
                {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Silver Mage" 4}
            #endif
        [/then]
        [/if]
    #enddef

    #define CHARACTER_ALLIANCE ID
        [store_unit]
            [filter]
                id={ID}
            [/filter]
            kill=yes
            variable=character
        [/store_unit]

        [if]
            [variable]
                name=character.canrecruit
                equals=yes
            [/variable]
        [then]
            {CLEAR_VARIABLE character.canrecruit}
        [/then]
        [/if]

        [if]
            [variable]
                name=character.id
                equals=Hamel
            [/variable]
        [then]
            {VARIABLE character.overlays "misc/hero-icon.png"}
        [/then]
        [/if]

        [if]
            [variable]
                name=character.id
                equals=Camerin
            [/variable]
        [then]
            {VARIABLE character.overlays "misc/loyal-icon.png"}
        [/then]
        [/if]

        {VARIABLE character.side 1}

        [unstore_unit]
            variable=character
        [/unstore_unit]

        {CLEAR_VARIABLE character}
    #enddef

    #define AI_ORCS
        [ai]
            time_of_day=dawn,morning,afternoon
            caution=0.4
            aggression=0.8
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,second_watch
            caution=0.0
            aggression=1.0
        [/ai]
    #enddef

    #define ORCISH_WARRIORS WARLORD
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Orcish Assassin,Troll Whelp,Orcish Warrior,Orcish Slayer,Troll,Troll Rocklobber,Orcish Crossbowman,Goblin Knight,Goblin Pillager,{WARLORD}
    #enddef

    #define ORCISH_IRON_TROOPS SIDE WARRIOR TROLL ROCKLOBBER CROSSBOWMAN SLAYER KNIGHT PILLAGER WARLORD STRENGTH
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Orcish Warrior" {WARRIOR}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Troll" {TROLL}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Troll Rocklobber" {ROCKLOBBER}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Orcish Crossbowman" {CROSSBOWMAN}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Orcish Slayer" {SLAYER}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Goblin Knight" {KNIGHT}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} "Goblin Pillager" {PILLAGER}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS {SIDE} {WARLORD} {STRENGTH}}
    #enddef

    #define HUMAN_IRON_TROOPS JAVELINEER SWORDSMAN PIKEMAN LONGBOWMAN OUTLAW TRAPPER
        {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Javelineer" {JAVELINEER}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Swordsman" {SWORDSMAN}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Pikeman" {PIKEMAN}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Longbowman" {LONGBOWMAN}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Outlaw" {OUTLAW}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Trapper" {TRAPPER}}
    #enddef

    #define DWARVISH_IRON_TROOPS STEELCLAD THUNDERGUARD STALWART
        {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Dwarvish Steelclad" {STEELCLAD}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Dwarvish Thunderguard" {THUNDERGUARD}}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Dwarvish Stalwart" {STALWART}} 
    #enddef

    [side]
        {PROTAGONIST_FORCES}
        {GOLD4 1100 900 700 500}
        user_team_name= _ "Alliance"
        {FLAG_VARIANT undead}
    [/side]

    [side]
        side=2
        controller=ai
        {GOLD4 1500 1300 1100 900}
        {INCOME4 40 30 20 10}
        no_leader=yes
        team_name=protagonist
        user_team_name= _ "Alliance"
        recruit=Spearman,Bowman,Footpad,Thug,Poacher,Javelineer,Swordsman,Pikeman,Longbowman,Outlaw,Trapper
        [ai]
            time_of_day=dawn,morning,afternoon
            caution=0.3
            aggression=0.8
            grouping=offensive
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,second_watch
            caution=0.6
            aggression=0.6
            grouping=defensive
        [/ai]
    [/side]

    # Note: Not using AI_CONTROLLER is for a purpose
    #       Player should be focused on his own troops not exercising issuing commands to ai

    [side]
        {PROTAGONIST_FORCES_ALLIED 3 ai knalgan}
        {GOLD4 1500 1300 1100 900}
        {INCOME4 40 30 20 10}
        type=Dwarvish Lord
        id=Hamel
        name= _ "Hamel"
        profile=portraits/Hamel.png
        canrecruit=yes
        unrenamable=yes
        [modifications]
            {TRAIT_LOYAL}
            {TRAIT_STRONG}
        [/modifications]
        user_team_name= _ "Alliance"
        recruit=Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Guardsman,Dwarvish Steelclad,Dwarvish Thunderguard,Dwarvish Stalwart
        [ai]
            time_of_day=dawn,morning,afternoon
            caution=0.3
            aggression=0.8
            grouping=offensive
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,second_watch
            caution=0.6
            aggression=0.6
            grouping=defensive
        [/ai]
    [/side]

    # Note: Not using AI_CONTROLLER is for a purpose
    #       Player should be focused on his own troops not exercising issuing commands to ai

    [side]
        side=4
        controller=ai
        type=Orcish Sovereign
        id=Rakshas
        profile=portraits/Rakshas.png
        name= _ "Rakshas"
        canrecruit=yes
        {GOLD4 1100 1400 1700 2000}
        {INCOME4 20 30 40 50}
        team_name=foe
        user_team_name={S_ORCS}
        {ORCISH_WARRIORS "Direwolf Rider"}
        {AI_ORCS}
        {FLAG_VARIANT ragged}
    [/side]

    [side]
        side=5
        controller=ai
        type=Orcish Warlord
        id=Vrogdhar
        name= _ "Vrogdar"
        role=Sovereign
        canrecruit=yes
        {GOLD4 1100 1400 1700 2000}
        {INCOME4 20 30 40 50}
        team_name=foe
        user_team_name={S_ORCS}
        {ORCISH_WARRIORS "Orcish Slurbow"}
        {AI_ORCS}
        {FLAG_VARIANT ragged}
    [/side]

    [side]
        side=6
        controller=ai
        type=Orcish Warlord
        id=Raolsg
        profile=portraits/orcs/transparent/grunt-3.png
        name= _ "Raolsg"
        role=Sovereign
        canrecruit=yes
        {GOLD4 1100 1400 1700 2000}
        {INCOME4 20 30 40 50}
        team_name=foe
        user_team_name={S_ORCS}
        {ORCISH_WARRIORS "Orcish Warlord"}
        {AI_ORCS}
        {FLAG_VARIANT ragged}
    [/side]

    [side]
        side=7
        controller=ai
        type=Orcish Warlord
        id=Ha'Grak
        name= _ "Ha'Grak"
        role=Sovereign
        canrecruit=yes
        {GOLD4 1100 1400 1700 2000}
        {INCOME4 20 30 40 50}
        team_name=foe
        user_team_name={S_ORCS}
        {ORCISH_WARRIORS "Troll Warrior"}
        {AI_ORCS}
        {FLAG_VARIANT ragged}
    [/side]

    [event]
        name=prestart

        {PLACE_IMAGE scenery/tent-ruin-1.png 25 54}
        {PLACE_IMAGE scenery/tent-ruin-1.png 31 57}
        {PLACE_IMAGE scenery/tent-ruin-1.png 26 56}
        {PLACE_IMAGE scenery/tent-ruin-1.png 35 53}
        {PLACE_IMAGE scenery/tent-ruin-1.png 28 57}
        {PLACE_IMAGE scenery/tent-ruin-1.png 33 56}

        #ifdef EASY
            {HUMAN_IRON_TROOPS 6 12 12 10 4 4}
            {DWARVISH_IRON_TROOPS 14 12 8}

            {ORCISH_IRON_TROOPS 4 4 4 4 6 4 2 2 "Direwolf Rider" 1}
            {ORCISH_IRON_TROOPS 5 4 4 4 6 4 2 2 "Orcish Slurbow" 1}
            {ORCISH_IRON_TROOPS 6 4 4 2 6 4 2 4 "Orcish Warlord" 1}
            {ORCISH_IRON_TROOPS 7 4 4 4 6 4 2 2 "Troll Warrior" 1}
        #endif

        #ifdef NORMAL
            {HUMAN_IRON_TROOPS 4 10 10 8 3 3}
            {DWARVISH_IRON_TROOPS 12 10 7}

            {ORCISH_IRON_TROOPS 4 6 6 6 8 4 2 2 "Direwolf Rider" 2}
            {ORCISH_IRON_TROOPS 5 6 6 6 8 4 2 2 "Orcish Slurbow" 2}
            {ORCISH_IRON_TROOPS 6 6 6 4 8 4 2 6 "Orcish Warlord" 2}
            {ORCISH_IRON_TROOPS 7 6 6 6 8 4 2 2 "Troll Warrior" 2}
        #endif

        #ifdef HARD
            {HUMAN_IRON_TROOPS 3 8 8 6 2 2}
            {DWARVISH_IRON_TROOPS 10 8 6}

            {ORCISH_IRON_TROOPS 4 8 8 8 10 5 3 3 "Direwolf Rider" 3}
            {ORCISH_IRON_TROOPS 5 8 8 8 10 5 3 3 "Orcish Slurbow" 3}
            {ORCISH_IRON_TROOPS 6 8 8 6 10 5 3 8 "Orcish Warlord" 3}
            {ORCISH_IRON_TROOPS 7 8 8 8 10 5 3 3 "Troll Warrior" 3}
        #endif

        #ifdef NIGHTMARE
            {HUMAN_IRON_TROOPS 2 6 6 4 2 1}
            {DWARVISH_IRON_TROOPS 8 6 4}

            {ORCISH_IRON_TROOPS 4 10 10 10 12 5 4 4 "Direwolf Rider" 4}
            {ORCISH_IRON_TROOPS 5 10 10 10 12 5 4 4 "Orcish Slurbow" 4}
            {ORCISH_IRON_TROOPS 6 10 10 6 12 7 4 10 "Orcish Warlord" 4}
            {ORCISH_IRON_TROOPS 7 10 10 10 12 5 4 4 "Troll Warrior" 4}
        #endif

        {VARIABLE light_source 1}
        {VARIABLE take_command 0}
        {VARIABLE steadfast_warrior 14}
    [/event]

    [event]
        name=start

        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Guard 23 28}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 24 27}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 26 26}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Guard 27 26}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 38 25}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Guard 39 26}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 40 26}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 40 30}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Guard 39 31}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 38 31}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 34 36}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Guard 33 37}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 32 37}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 28 37}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Guard 27 37}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Guard 26 36}

        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Warlord 36 26}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Warlord 36 28}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Warlord 36 30}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Warlord 32 35}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Warlord 31 36}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Warlord 30 35}
        {PUT_STRONGHOLD_GUARD "Orcish Slurbow" Warlord 29 36}
        {PUT_STRONGHOLD_GUARD "Orcish Warlord" Warlord 28 35}

        {UNIT 3 "White Mage" 11 3 (
            gender=female
            id=Sister Thera
            name= _ "Sister Thera"
            profile=portraits/Sister_Thera.png
            unrenamable=yes
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_QUICK}
            [/modifications]
            {IS_LOYAL}
        )}
        {UNIT 2 "White Mage" 56 4 (
            id=Father Morvin
            name= _ "Father Morvin"
            profile=portraits/Father_Morvin.png
            unrenamable=yes
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        )}

        [if]
            [variable]
                name=human_leader_name
                equals=Camerin
            [/variable]
        [then]
            {UNIT 2 "Great Mage" 53 6 (
                id=Camerin
                name= _ "Camerin"
                role=Commander
                profile=portraits/Camerin.png
                unrenamable=yes
                canrecruit=yes
                [modifications]
                    {TRAIT_LOYAL}
                    {TRAIT_STRONG}
                [/modifications]
            )}

            {OBJECTIVES_SILENCE ( _ "Death of Camerin")}
        [/then]
        [else]
            [if]
                [variable]
                    name=human_leader_name
                    equals=Dendrvan
                [/variable]
            [then]
                {UNIT 2 "Halberdier" 53 6 (
                    id=Dendrvan
                    name= _ "Dendrvan"
                    role=Commander
                    unrenamable=yes
                    canrecruit=yes
                    [modifications]
                        {TRAIT_QUICK}
                        {TRAIT_RESILIENT}
                    [/modifications]
                )}

                {OBJECTIVES_SILENCE ( _ "Death of Dendrvan")}
            [/then]
            [else]
                {UNIT 2 "Royal Guard" 53 6 (
                    id=Rhodry
                    name= _ "Rhodry"
                    role=Commander
                    profile=portraits/humans/transparent/swordsman-2.png
                    unrenamable=yes
                    canrecruit=yes
                    [modifications]
                        {TRAIT_RESILIENT}
                        {TRAIT_STRONG}
                    [/modifications]
                )}

                {OBJECTIVES_SILENCE ( _ "Death of Rhodry")}
            [/else]
            [/if]

            [recall]
                id=Eryssa
            [/recall]
            [recall]
                id=Elenia
            [/recall]
            [recall]
                id=Hidel
            [/recall]
            [recall]
                id=Sisal
            [/recall]

            [store_unit]
                [filter]
                    id=Eryssa
                [/filter]
                kill=yes
                variable=princess
            [/store_unit]

            {VARIABLE princess.overlays "misc/loyal-icon.png"}

            [unstore_unit]
                variable=princess
            [/unstore_unit]

            {CLEAR_VARIABLE princess}

            {CREATE_ABYSS}
        [/else]
        [/if]

        [capture_village]
            side=1
            x=25,31,26,35,28,33
            y=54,57,56,53,57,56
        [/capture_village]
        [capture_village]
            side=2
            x=47,55,56,56,58,59
            y=3,3,1,4,5,8
        [/capture_village]
        [capture_village]
            side=3
            x=5,7,9,11,6,9
            y=2,2,2,3,4,7
        [/capture_village]
        [capture_village]
            side=4
            x=28,25,34,34
            y=27,29,28,30
        [/capture_village]
        [capture_village]
            side=5
            x=26,27
            y=31,33
        [/capture_village]
        [capture_village]
            side=6
            x=33,35
            y=33,32
        [/capture_village]
        [capture_village]
            side=7
            x=31,33
            y=27,27
        [/capture_village]

        {SPEAKER_GENERIC (speaker=Raolsg) ( _ "Master! Master! The Silent Warlord is here!")}
        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "It is just a foul necromancer!")}
        {SPEAKER_GENERIC (speaker=Eryssa) ( _ "He is not. He is a lot more than that.")}
        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Hahahahah! Fools you are in the heart of my lands, soon more troops will arrive and then I will crush you easily, like a pest!")}
        {SPEAKER_GENERIC (speaker=Hamel) ( _ "Look around no one will come. We saw some orcs but they were running away!")}
        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "You are really pathetic!... Vermin will always ally with vermin.")}
        {SPEAKER_GENERIC (speaker=Tallin) ( _ "Silence is always the same. No matter who brings it.")}
        {SPEAKER_GENERIC (speaker=Hamel) ( _ "It’s called ‘The End’, foul orc. Forward! FOR KNALGA!!")}

        [if]
            [have_unit]
                side=2
                id=Camerin
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Camerin) ( _ "FOR FUN!")}
        [/then]
        [else]
            {SPEAKER_GENERIC (role=Commander) ( _ "FOR DWARVEN DOORS!!")}
        [/else]
        [/if]

        {SPEAKER_GENERIC (speaker=Tallin) ( _ "For... the purpose.")}
    [/event]

    [event]
        name=new turn
        first_time_only=no

        [if]
            [variable]
                name=leader_died
                greater_than=0
            [/variable]
        [then]
            {CLEAR_VARIABLE leader_died}
        [/then]
        [/if]

        [if]
            [variable]
                name=light_source
                greater_than=6
            [/variable]
        [then]
            {VARIABLE light_source 1}
        [/then]
        [/if]

        {VARIABLE_OP light_source add 1}

        [store_unit]
            [filter]
                side=1
                type=Shadow,Nightgaunt
                x=30-34,28-35,26-29,31-35,25-27,33-35,24-27,33-35,24-27,33-34,24-28,32-36,25-37,27-35,29,31
                y=26,27,28,28,29,29,30,30,31,31,32,32,33,34,35,35
            [/filter]
            kill=no
            variable=assaulters
        [/store_unit]

        [if]
            [variable]
                name=assaulters[0].x
                greater_than=0
            [/variable]
            [and]
                [variable]
                    name=light_source
                    less_than=6
                [/variable]
            [/and]
        [then]
            {PROTECT_SOVEREIGN}
        [/then]
        [/if]

        {CLEAR_VARIABLE assaulters}
    [/event]

    [event]
        name=turn 5

        [if]
            [have_unit]
                side=2
                id=Camerin
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Camerin) ( _ "Woohaa, look at all those orcs pouring out of that fortress, that will be good!")}
        [/then]
        [else]
            {SPEAKER_GENERIC (role=Commander) ( _ "Sweet gods, look at all those orcs pouring out of that fortress.")}
        [/else]
        [/if]

        {SPEAKER_GENERIC (speaker=Hamel) ( _ "Aye, and not just any orcs either, many of them are hardened veterans!")}
        {SPEAKER_GENERIC (speaker=Tallin) ( _ "Yeah, it looks like a time consuming task, but the end is always the same.")}
        {SPEAKER_GENERIC (speaker=Hamel) ( _ "So make sure that we will survive until that moment... Speaker.")}
    [/event]

    [event]
        name=turn 8

        [if]
            [variable]
                name=wizards_arrived
                less_than=1
            [/variable]
        [then]
            {SPEAKER_GENERIC (speaker=Raolsg) ( _ "Master this is useless. The Silent Warlord will kill us all! We must surrender!")}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "The world hates those like him far more than us! Soon we will receive reinforcements!")}
            {SPEAKER_GENERIC (speaker=Raolsg) ( _ "But!...")}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Shut up moron! Unless you want join the troops of the Silent Warlord!")}
        [/then]
        [/if]
    [/event]

    [event]
        name=turn 12

        {WIZARDS_ARRIVE 6 33 33}
    [/event]

    [event]
        name=moveto

        [filter]
            side=4,5,6,7
            x=48-59,49-59,51-59,55-59
            y=1-9,10,11,12
        [/filter]

        [gold]
            side=2
            amount=500
        [/gold]

        [if]
            [have_unit]
                side=2
                id=Camerin
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Camerin) ( _ "It's real fun here Tallin! But if you do not want it to end early, you better do something! For now I will prepare a little surprise for them.")}
        [/then]
        [else]
            {SPEAKER_GENERIC (role=Commander) ( _ "Call reinforcements! The Speaker we will not hold up much longer!")}
        [/else]
        [/if]
    [/event]

    [event]
        name=moveto

        [filter]
            side=4,5,6,7
            x=1-20,1-19,1-17,1-16
            y=1-7,8,9,10
        [/filter]

        [gold]
            side=3
            amount=500
        [/gold]

        {SPEAKER_GENERIC (speaker=Hamel) ( _ "Speaker! If ye are up to do something do it now! We can't stand against them forever! FORWARD!!")}
    [/event]

    [event]
        name=moveto

        [filter]
            side=1,2,3
            x=24,25,26-27,28,29,30,31,32-34,35,36,37
            y=30-32,29-33,28-34,27-34,27-35,26-34,26-35,26-34,35-34,32-33,33
            [not]
                type=Shadow,Nightgaunt,Fugitive
            [/not]
        [/filter]

        {PROTECT_SOVEREIGN}
    [/event]

    [event]
        name=moveto

        [filter]
            side=2
            type=Fugitive
            x=30-34,29-30,32,34-35,26-33,35,26-35,24-33,35,24-25,27-34,24-34,36,25-26,28-32,34-36,27-35,29,31
            y=26,27,27,27,28,28,29,30,30,31,31,32,32,33,33,33,34,35,35
        [/filter]

        {PROTECT_SOVEREIGN}
    [/event]

    [event]
        name=moveto
        first_time_only=no

        [filter]
            side=1
            type=Shadow,Nightgaunt
            x=30-34,28-35,26-29,31-35,25-27,33-35,24-27,33-35,24-27,33-34,24-28,32-36,25-37,27-35,29,31
            y=26,27,28,28,29,29,30,30,31,31,32,32,33,34,35,35
        [/filter]

        [if]
            [variable]
                name=light_source
                less_than=6
            [/variable]
        [then]
            {PROTECT_SOVEREIGN}
        [/then]
        [else]
            [allow_undo][/allow_undo]
        [/else]
        [/if]
    [/event]

    [event]
        name=capture

        [filter]
            x=33,35
            y=33,32
        [/filter]

        {WIZARDS_ARRIVE 4 25 29}
    [/event]

    [event]
        name=capture

        [filter]
            x=28,25,34,34,26,27,31,33
            y=27,29,28,30,31,33,27,27
        [/filter]

        {WIZARDS_ARRIVE 6 33 33}
    [/event]

    {FORCE_CHANCE_TO_HIT side=4,5,6,7 id=$human_leader_name 0 (
        [variable]
            name=turn_number
            less_than=$steadfast_warrior
        [/variable]
        [variable]
            name=second_unit.hitpoints
            less_than=50
        [/variable]
    )}

    {FORCE_CHANCE_TO_HIT side=4,5,6,7 id=Hamel 0 (
        [variable]
            name=turn_number
            less_than=$steadfast_warrior
        [/variable]
        [variable]
            name=second_unit.hitpoints
            less_than=50
        [/variable]
    )}

    [event]
        name=attack

        [filter_second]
            side=5,7
            canrecruit=yes
        [/filter_second]

        {WIZARDS_ARRIVE 6 33 33}
    [/event]

    [event]
        name=attack

        [filter]
            side=5,7
            canrecruit=yes
        [/filter]

        {WIZARDS_ARRIVE 6 33 33}
    [/event]

    [event]
        name=attack

        [filter_second]
            side=6
            canrecruit=yes
        [/filter_second]

        {WIZARDS_ARRIVE 4 25 29}
    [/event]

    [event]
        name=attack

        [filter]
            side=6
            canrecruit=yes
        [/filter]

        {WIZARDS_ARRIVE 4 25 29}
    [/event]

    [event]
        name=attack

        [filter_second]
            side=4
            canrecruit=yes
        [/filter_second]

        {PROTECT_SOVEREIGN}
    [/event]

    [event]
        name=attack

        [filter]
            side=4
            canrecruit=yes
        [/filter]

        {PROTECT_SOVEREIGN}
    [/event]

    [event]
        name=attack

        [filter]
            side=1,2
            x=24,25,26-27,28,29,30,31,32-34,35,36,37
            y=30-32,29-33,28-34,27-34,27-35,26-34,26-35,26-34,35-34,32-33,33
        [/filter]

        {PROTECT_SOVEREIGN}
    [/event]

    [event]
        name=attack

        [filter_second]
            side=1,2
            x=24,25,26-27,28,29,30,31,32-34,35,36,37
            y=30-32,29-33,28-34,27-34,27-35,26-34,26-35,26-34,35-34,32-33,33
        [/filter_second]

        {PROTECT_SOVEREIGN}
    [/event]

    [event]
        name=victory

        {CHARACTER_ALLIANCE Hamel}
        {CHARACTER_ALLIANCE $human_leader_name}
        {CHARACTER_ALLIANCE "Sister Thera"}
        {CHARACTER_ALLIANCE "Father Morvin"}

        {CLEAR_VARIABLE guards_protect}
        {CLEAR_VARIABLE deny_command}
        {CLEAR_VARIABLE take_command}
        {CLEAR_VARIABLE light_source}
        {CLEAR_VARIABLE steadfast_warrior}
        {CLEAR_VARIABLE leader_died}
        {CLEAR_VARIABLE wizards_arrived}

        {CLEAR_ROLE_ABYSS}
    [/event]

    [event]
        name=last breath
        first_time_only=no

        [filter]
            side=5,6,7
            canrecruit=yes
        [/filter]

        [if]
            [have_unit]
                side=4
                canrecruit=yes
            [/have_unit]
            [and]
                [variable]
                    name=deny_command
                    less_than=1
                [/variable]
            [/and]
        [then]
            [if]
                [have_unit]
                    side=4
                    role=Warlord
                [/have_unit]
            [then]
                {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Take over command and bring reinforcements! Go!")}
            [/then]
            [/if]

            [if]
                [variable]
                    name=take_command
                    less_than=3
                [/variable]
            [then]
                [if]
                    [have_unit]
                        side=4
                        role=Warlord
                    [/have_unit]
                [then]
                    [if]
                        [variable]
                            name=leader_died
                            not_equals=1
                        [/variable]
                    [then]
                        {TAKE_COMMAND $unit.side}
                    [/then]
                    [else]
                        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "WHAT?! NO ONE LEFT TO LEAD! COWARDS!! YOU ARE NOT ORCS!!")}

                        {VARIABLE deny_command 1}
                    [/else]
                    [/if]
                [/then]
                [/if]

                [if]
                    [variable]
                        name=unit.id
                        not_equals=Leogwyndar
                    [/variable]
                [then]
                    {VARIABLE_OP take_command add 1}
                    {VARIABLE leader_died 1}
                [/then]
                [/if]

                [if]
                    [have_unit]
                        side=6
                        id=Leogwyndar
                    [/have_unit]
                    [and]
                        [variable]
                            name=take_command
                            greater_than=1
                        [/variable]
                    [/and]
                [then]
                    {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "Emperor Rakshas unfortunately I received urgent summons from the master of our guild...")}
                    {SPEAKER_GENERIC (speaker=Rakshas) ( _ "WHAT?!! You are breaking our agreement?! You lousy, tricky, human!")}
                    {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "No. Nothing like that! However given the circumstances I fear that you can no longer satisfy the conditions. That is, to give us land.")}
                    {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Stay here! You promised me to bring great shamans that will burn those disgusting corpses!")}
                    {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "So you can keep all the mages that still remain on the battlefield. If you survive this battle, you can report me to the master of the guild. I can ensure you that we will examine your complaints very carefully.")}
                    {SPEAKER_GENERIC (speaker=Rakshas) ( _ "KILL HIM!")}

                    {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Red Mage" 0}
                    {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Silver Mage" 0}

                    {ANIMATE_UNIT Leogwyndar pre_teleport ()}
                    [hide_unit]
                        id=Leogwyndar
                    [/hide_unit]

                    [if]
                        [have_unit]
                            side=4
                            role=Warlord
                        [/have_unit]
                        [and]
                            [variable]
                                name=deny_command
                                less_than=1
                            [/variable]
                        [/and]
                    [then]
                        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Cowardly traitors, human shamans! What you are waiting for take over command!")}

                        {TAKE_COMMAND 6}
                    [/then]
                    [else]
                        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Humans! Cowardly traitors, you are necromancers not shamans!")}
                    [/else]
                    [/if]

                    [kill]
                        id=Leogwyndar
                    [/kill]
                [/then]
                [/if]
            [/then]
            [else]
                {SPEAKER_GENERIC (speaker=Rakshas) ( _ "WHAT?! NO ONE LEFT TO LEAD! COWARDS!! YOU ARE NOT ORCS!!")}

                {VARIABLE deny_command 1}
            [/else]
            [/if]
        [/then]
        [/if]

        {VARIABLE_OP steadfast_warrior add 2}
    [/event]

    [event]
        name=last breath

        [filter]
            side=4
            canrecruit=yes
        [/filter]

        {SPEAKER_GENERIC (speaker=Hamel) ( _ "Learn the fate of one who offends the Dwarves of Knalga.")}
        {SPEAKER_GENERIC (speaker=Eryssa) ( _ "Or the elves of the Northern Forests.")}

        [if]
            [have_unit]
                side=2
                id=Camerin
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Camerin) ( _ "Or play with fire!")}
        [/then]
        [else]
            {SPEAKER_GENERIC (role=Commander) ( _ "Or the humans of Dwarven Doors.")}
        [/else]
        [/if]

        {SPEAKER_GENERIC (speaker=Rakshas) ( _ "(<i>Gurgle</i>) This can't end like... This...")}
        {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Such were the last words of Rakshas the great!")}

        {VARIABLE_OP steadfast_warrior add 2}
    [/event]

    # This are revised events from herodeaths. Modifications are as follows:
    # Mages are respawned at fixed location to avoid slowing down orcs
    [event]
        name=last breath
        first_time_only=no
        [filter]
            id=Sister Thera
        [/filter]
        {RANDOM 1..7}

        [switch]
            variable=random
            [case]
                value=1
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Ahhhh! Save me, my husband!")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "(<i>Rolls eyes</i>) Dramatic as always.")}
            [/case]
            [case]
                value=2
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Ahhhhhhh!")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "You monsters think you are so tough don’t you? Well check this out.")}
            [/case]
            [case]
                value=3
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Ahhhhhhh!")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "You incompetent fools, you think you can kill us? Good luck!")}
            [/case]
            [case]
                value=4
                # wmllint: local spelling Ack!
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Ack! Stupid slobbering beast!")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Your efforts to destroy us are in vain, you foul creature.")}
            [/case]
            [case]
                value=5
                [if]
                    [have_unit]
                        id=Father Morvin
                    [/have_unit]
                    [then]
                        {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Oh no, Morvin! We have failed in our mission to help Tallin!")}
                        {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Failed? Never! The word failure is not in our dictionary.")}
                    [/then]
                [/if]
            [/case]
            [case]
                value=6
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Alas! I am dying! Morvin darling, I wish you were beside me so that I may die in your arms! So that I may feel the kiss of your lips on mine one last time!")}
                [if]
                    [have_unit]
                        id=Father Morvin
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "(<i>Rolls eyes</i>) Thera, do you always have to be so dramatic?")}
                    [if]
                        [have_unit]
                            side=2
                            id=Camerin
                        [/have_unit]
                    [then]
                        {SPEAKER_GENERIC (speaker=Camerin) ( _ "Awww, you don't gonna miss her?")}
                    [/then]
                    [else]
                        {SPEAKER_GENERIC (role=Commander) ( _ "Um... Father? Your wife just got killed...")}
                    [/else]
                    [/if]

                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Oh right. I CALL UPON THE LORDS OF LIGHT TO GRANT YOU LIFE!")}
                [/then]
                [/if]
            [/case]
            [else]
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "You cruel creature! How dare you use your brute strength against such a frail creature as me.")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Don’t worry, Thera, you will have plenty of opportunities to set him straight.")}
            [/else]
        [/switch]

        # Store unit to check if it advanced to mage of light
        [store_unit]
            [filter]
                id=Sister Thera
            [/filter]
            variable=type_check
            kill=yes
            fire_event=no
        [/store_unit]
        {UNIT 3 $type_check.type 11 3 (
            gender=female
            id=Sister Thera
            name= _ "Sister Thera"
            profile=portraits/Sister_Thera.png
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_QUICK}
                [object]
                    silent=yes
                    duration=forever
                    [effect]
                        apply_to=new_animation

	                    [extra_anim]
		                    flag=resurrection

                            halo_auto_vflip=false
                            [halo_frame]
                                duration=730
                                halo="halo/holy/light-beam-[1~7,6~1].png:[30*6,130,70*6]"
                            [/halo_frame]
                        [/extra_anim]
                    [/effect]
                [/object]
            [/modifications]
            {IS_LOYAL}
            moves=0
            attacks_left=0
        )}

        [sound]
            name=magic-holy-1.ogg
        [/sound]
        {ANIMATE_UNIT "Sister Thera" resurrection ()}
        {CLEAR_VARIABLE type_check}

        [switch]
            variable=random
            [case]
                value=1
                [if]
                    [have_unit]
                        id=Father Morvin
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Thera, when this is all over, you should paint your face and join a theater.")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Hey, don’t you always say that life is nothing but a drama?")}
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Yes, it may be a drama, but that’s no excuse for overacting!")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "(<i>Giggle</i>) Who needs an excuse for overacting?")}
                [/then]
                [/if]
            [/case]
            [case]
                value=2
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Whoa! That trick is a bit hard on the constitution.")}
                [if]
                    [have_unit]
                        id=Father Morvin
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Well, be grateful that you are alive.")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "(<i>Giggle</i>) Thank you, honey.")}
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Thank the Lords of Light, not me!")}
                [/then]
                [/if]
            [/case]
            [case]
                value=3
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Ouch! That hurts. Let’s try not to do that again, shall we?")}
            [/case]
            [case]
                value=4
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "There we go, payback time!")}
            [/case]
            [case]
                value=5
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "There we go, let’s give this one more shot!")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Just try not to kill yourself again.")}
            [/case]
            [case]
                value=6
                [if]
                    [have_unit]
                        id=Father Morvin
                    [/have_unit]
                [then]
                    # wmllint: local spelling unclerical
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Thera, you should know by now that it is very unclerical to make such a spectacle of yourself.")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Come on, honey! Those were my dying words, after all!")}
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "(<i>Rolls eyes</i>) Women!")}
                [/then]
                [/if]
            [/case]
            [else]
                [if]
                    [have_unit]
                        id=Father Morvin
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "That’s darned right!")}
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Thera! Language like that coming from you! You should really stop hanging around the dwarves so much.")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "(<i>Giggle</i>) Sorry.")}
                [/then]
                [/if]
            [/else]
        [/switch]

        {CLEAR_VARIABLE random}
    [/event]

    [event]
        name=last breath
        first_time_only=no
        [filter]
            id=Father Morvin
        [/filter]

        {RANDOM 1..7}
        [switch]
            variable=random
            [case]
                value=1
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Alas! So... close.")}
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Hey, that’s not right. The good guys aren’t supposed to die. Oh well, I’ll fix that.")}
            [/case]
            [case]
                value=2
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Argh!")}
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "You incompetent fools, you think you can kill us? Good luck!")}
            [/case]
            [case]
                value=3
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Argh!")}
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Oh dear. Did you just go and get yourself killed again, Morvin? Well, I’ll fix that.")}
            [/case]
            [case]
                value=4
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "The forces of good can never be defeated by the likes of you!")}
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Yeah, try taking a bath and you <i>might</i> be able to kill him for good (<i>Wink wink</i>). But for the time being, abracadabra!")}
            [/case]
            [case]
                value=5
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Argh!")}
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Stupid troll, maybe next time you should try killing someone who can be killed.")}
            [/case]
            [case]
                value=6
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Argh! I’ll just come back and finish you in my next life.")}
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Which might be sooner than you think.")}
            [/case]
            [else]
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Ack! I have been brained!")}
                # wmllint: local spelling Eew
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Eew! Gross! Ahh never mind, I’ll get you cleaned up good.")}
            [/else]
        [/switch]

        [store_unit]
            [filter]
                id=Father Morvin
            [/filter]
            variable=type_check
            kill=yes
            fire_event=no
        [/store_unit]
        {UNIT 2 $type_check.type 56 4 (
            id=Father Morvin
            name= _ "Father Morvin"
            profile=portraits/Father_Morvin.png
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
                [object]
                    silent=yes
                    duration=forever
                    [effect]
                        apply_to=new_animation

	                    [extra_anim]
		                    flag=resurrection

                            halo_auto_vflip=false
                            [halo_frame]
                                duration=730
                                halo="halo/holy/light-beam-[1~7,6~1].png:[30*6,130,70*6]"
                            [/halo_frame]
                        [/extra_anim]
                    [/effect]
                [/object]
            [/modifications]
            {IS_LOYAL}
            moves=0
            attacks_left=0
        )}

        [sound]
            name=magic-holy-1.ogg
        [/sound]
        {ANIMATE_UNIT "Father Morvin" resurrection ()}
        {CLEAR_VARIABLE type_check}

        [switch]
            variable=random
            [case]
                value=1
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "There we go.")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Ahh yes, that’s better.")}
            [/case]
            [case]
                value=2
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Ouch! That hurts. Let’s try not to do that again, shall we?")}
            [/case]
            [case]
                value=3
                [if]
                    [have_unit]
                        id=Sister Thera
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Morvin! You bad boy, always getting into trouble.")}
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Sorry, won’t do it again. Promise!")}
                [/then]
                [/if]
            [/case]
            [case]
                value=4
                [if]
                    [have_unit]
                        id=Sister Thera
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "I heard that, Thera.")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Hey, just trying to give him an incentive to drown himself.")}
                [/then]
                [/if]
            [/case]
            [case]
                value=5
                # no message for this case
            [/case]
            [case]
                value=6
                {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "See?")}
                {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Now where did he go?!")}
            [/case]
            [else]
                [if]
                    [have_unit]
                        id=Sister Thera
                    [/have_unit]
                [then]
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Ahhh, Thera, you would make such a good housewife!")}
                    # wmllint: local spelling pouty
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Yes, if you would ever buy me a house! (<i>Pouty face</i>)")}
                    {SPEAKER_GENERIC (speaker=Father Morvin) ( _ "Thera, don’t you think that this isn’t really a good time to talk about that?")}
                    {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "(<i>Giggle</i>) Sorry!")}
                [/then]
                [/if]
            [/else]
        [/switch]

        {CLEAR_VARIABLE random}
    [/event]

    [event]
        name=last breath

        [filter]
            id=Elenia
        [/filter]

        {SPEAKER_GENERIC (speaker=Elenia) ( _ "Alas! My wanderings have come to an end.")}
        {SPEAKER_GENERIC (speaker=Sister Thera) ( _ "Farewell Elenia. May you find peace in your final journey.")}
    [/event]

    [event]
        name=last breath

        [filter]
            id=Hidel
        [/filter]

        {SPEAKER_GENERIC (speaker=Eryssa) ( _ "Hidel!...")}

        [if]
            [have_unit]
                side=1
                id=Eryssa
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=unit) ( _ "It's nothing serious... Really...")}
        [/then]
        [/if]
    [/event]

    [event]
        name=last breath

        [filter]
            id=Sisal
        [/filter]

        [if]
            [have_unit]
                side=1
                id=Hidel
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Eryssa) ( _ "Noooo! Sisal!")}
        [/then]
        [else]
            {SPEAKER_GENERIC (speaker=Eryssa) ( _ "Sisal! Noooo! Not you too!")}
        [/else]
        [/if]

        [if]
            [have_unit]
                side=1
                id=Eryssa
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=unit) ( _ "Worry not... Brave warriors never die.")}
        [/then]
        [/if]
    [/event]

    [event]
        name=last breath

        [filter]
            id=Eryssa
        [/filter]

        {SPEAKER_GENERIC (speaker=unit) ( _ "Alas, you must continue your mission without me!")}

        [if]
            [have_unit]
                side=1
                id=Elenia
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Elenia) ( _ "Eryssa, no! Please don’t die!")}
        [/then]
        [else]
            [if]
                [have_unit]
                    side=1
                    id=Hidel
                [/have_unit]
            [then]
                {SPEAKER_GENERIC (speaker=Hidel) ( _ "Princess!")}
            [/then]
            [else]
                {SPEAKER_GENERIC (speaker=Sisal) ( _ "Princess!")}
            [/else]
            [/if]
        [/else]
        [/if]
    [/event]

    [event]
        name=last breath

        [filter]
            side=2
            canrecruit=yes
        [/filter]

        [if]
            [variable]
                name=unit.id
                equals=Camerin
            [/variable]
        [then]
            {SPEAKER_GENERIC (speaker=Camerin) ( _ "What... how can this happen?")}
        [/then]
        [else]
            {SPEAKER_GENERIC (role=Commander) ( _ "I knew we shouldn't trust... Someone like you...")}
        [/else]
        [/if]
    [/event]

    [event]
        name=last breath

        [filter]
            side=3
            canrecruit=yes
        [/filter]

        {SPEAKER_GENERIC (speaker=unit) ( _ "Curse you, you doomed us all...")}
    [/event]

    [event]
        name=die

        [filter]
            side=4
            canrecruit=yes
        [/filter]

        {SPEAKER_GENERIC (role=Sovereign) ( _ "GIVE THEM DEATH!!!")}

        {ORCISH_REINFORCEMENT 5 550 700 850 1000}
        {ORCISH_REINFORCEMENT 7 550 700 850 1000}

        [if]
            [have_unit]
                side=6
                id=Leogwyndar
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (speaker=Leogwyndar) ( _ "Hey we are the good ones! Damned necromancers and their slaves, they didn't notice... Let's get out of here before we draw their attention.")}
            {ANIMATE_UNIT Leogwyndar pre_teleport ()}

            [kill]
                id=Leogwyndar
            [/kill]

            [kill]
                side=6
                race=human
            [/kill]
        [/then]
        [else]
            {ORCISH_REINFORCEMENT 6 550 700 850 1000}
        [/else]
        [/if]
    [/event]

    [event]
        name=die

        [filter]
            id=Leogwyndar
        [/filter]

        {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Red Mage" 0}
        {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Silver Mage" 0}

        [role]
            side=6
            race=human
            role=Wizard
        [/role]

        [if]
            [have_unit]
                side=6
                role=Wizard
            [/have_unit]
        [then]
            {SPEAKER_GENERIC (role=Wizard) ( _ "Leogwyndar is dead! We must return to the guild. Lets get out of here!")}
            {SPEAKER_GENERIC (speaker=Rakshas) ( _ "Get back here cowards!!!")}

            [kill]
                side=6
                race=human
            [/kill]
        [/then]
        [/if]
    [/event]

    {IMPORTANT_CHARACTER_DIED Hamel}
    {IMPORTANT_CHARACTER_DIED $human_leader_name}
    {LEADER_DEATH ( _ "So this is how it looks like...")}

    #undef OBJECTIVES_SILENCE
    #undef PUT_STRONGHOLD_GUARD
    #undef ORCISH_REINFORCEMENT
    #undef ORCISH_ARMY
    #undef TAKE_COMMAND
    #undef WIZARDS_ARRIVE
    #undef PROTECT_SOVEREIGN
    #undef CHARACTER_ALLIANCE
    #undef AI_ORCS
    #undef ORCISH_WARRIORS
    #undef ORCISH_IRON_TROOPS
    #undef HUMAN_IRON_TROOPS
    #undef DWARVISH_IRON_TROOPS
[/scenario]
